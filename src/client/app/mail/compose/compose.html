<compose-header></compose-header>

<form class="compose" name="sendForm" ng-submit="vm.send(sendForm)" novalidate>
    <div class="div">
        <div class="compose-from mrg--t20">
            <div class="compose-from__item font__size13" ng-if="vm.$state.params.template">
                <button class="btn btn--size_s btn--yellow btn--border-yellow btn--act--y-shw width--inh"
                        type="button"
                        ng-click="vm.saveTemplate()">
                    {{ 'BTN_CREATE_TEMPLATE' | translate }}
                </button>
            </div>
            <div class="compose-from__item font__size13">
                <button class="btn btn--size_s btn--yellow btn--border-yellow btn--act--y-shw width--inh" type="submit">
                    {{ 'SEND' | translate }}
                </button>
            </div>
            <div class="compose-from__item font__size13">{{ 'FROM_WHOM' | translate }}:</div>
            <div class="compose-from__item font__size15">
                <div class="avatar avatar--size28">
                    <img class="avatar__image" src="/images/avatar.png">
                </div>
            </div>
            <div class="compose-from__item font__size15 width--inh">
                <ui-select ng-model="vm.sendForm.model.from_connection"
                           class="select-list select-list--size_l select-list--no-border select-list--not-border-of-sides width-inh "
                           theme="select2"
                           search-enabled="false">
                    <ui-select-match class="select-list__body select-list--size_l width-inh">
                        {{ $select.selected.email }}
                    </ui-select-match>
                    <ui-select-choices repeat="connection.id as connection in vm.connections.items"
                                       ng-value="$select.selected.id">s
                        <div ng-bind="connection.email"></div>
                    </ui-select-choices>
                </ui-select>
            </div>
            <!--<div class="compose-from__item font&#45;&#45;size13">-->
            <!--<button class="btn-y" type="button">-->
            <!--({{ vm.user.profile.email }})-->
            <!--<span class="btn-y__icon btn-y__icon&#45;&#45;arrow icon-arrow-down"></span>-->
            <!--</button>-->
            <!--</div>-->
        </div>

        <div class="input-line input-line--full">
            <label class="input-line__label">
                <a class="link link--gray link--hv-red font__size13 mrg--r5" href>{{ 'TO' | translate }}</a>
            </label>
            <div class="input-line__links">
                <a class="link link--violet link--hv-red font__size13 mrg--r5" href>
                    СМС
                </a>
                <a class="link link--violet link--hv-red font__size13 mrg--r5" href ng-click="vm.isCopy = true">
                    {{ 'IS_COPY' | translate }}
                </a>
                <a class="link link--violet link--hv-red font__size13 mrg--r5" href="#"
                   ng-click="vm.isCopyHidden = true">
                    {{ 'IS_HIDDEN_COPY' | translate }}
                </a>
            </div>
            <contact-to-add-select addresses="vm.sendForm.model.to"
                                   required="true"
                                   name="to"></contact-to-add-select>
        </div>

        <div class="input-line__error" ng-if="sendForm.to.$invalid && sendForm.$submitted">
            {{ 'IS_NOT_FIELD_ENTER_ADDRESS' | translate }}.
        </div>

        <div class="input-line input-line--full" ng-if="vm.isCopy">
            <label class="input-line__label">
                <a class="link link--gray link--hv-re font__size13" href=""> {{ 'IS_COPY' | translate }}</a>
            </label>
            <contact-to-add-select addresses="vm.sendForm.model.toCopy"></contact-to-add-select>
        </div>

        <div class="input-line input-line--full" ng-if="vm.isCopyHidden">
            <label class="input-line__label">
                <a class="link link--gray link--hv-re font__size13" href="">{{ 'HIDDEN' |translate }}</a>
            </label>
            <contact-to-add-select addresses="vm.sendForm.model.toCopyHidden"></contact-to-add-select>
        </div>

        <div class="input-line input-line--full">
            <label class="input-line__label">
                <a class="link link--gray link--hv-re font__size13" href="">СМС</a>
            </label>
            <contact-to-add-select addresses="vm.sendForm.model.toCopy"></contact-to-add-select>
        </div>

        <div class="input-line input-line--full">
            <div class="input-line__body">
                <label class="input-line__label">
                    <a class="link link--gray link--hv-re font__size13" href="">{{ 'SUBJECT' | translate }}</a>
                </label>
                <div class="input-line__links">
                    <a class="link link--violet link--hv-red font__size13"
                       href
                       uib-popover-template="'app/components/template-list/template-list-popover.html'"
                       popover-class="popover--template-list"
                       popover-placement="bottom-right"
                       popover-animation="true"
                       popover-trigger="'outsideClick'">
                        {{ 'TEMPLATE' | translate }}
                    </a>
                </div>
                <input class="input-line__input" type="text"
                       ng-model="vm.sendForm.model.subject">
            </div>
        </div>

        <!--<div class="mrg--t20"> </div>-->
    </div>
    <div class="div">
        <div class="mrg--t20"
             message-textarea
             message-textarea-html="vm.sendForm.model.body"
             ng-model="vm.sendForm.model.body"></div>

        <div class="row mrg--t20">
            <div class="col-xs-6">

                <!--<compose-send></compose-send>-->

                <div class="compose-send">
                    <div class="btn-group compose-send__item">
                        <button class="btn-group__btn btn btn--size_l btn--yellow btn--border-yellow btn--act--y-shw"
                                type="submit">{{ 'SEND' | translate }}
                            <to-date date-unix="vm.sendForm.model.sdate" is-send-time="true"></to-date>
                        </button>
                        <button class="btn-group__btn btn btn--size_l btn--yellow btn--border-yellow flex padding--left10 padding--right10 "
                                type="button"
                                uib-popover-template="'app/components/time-send/time-send-popover.html'"
                                popover-class="popover--time-send popover--no-arrow"
                                popover-placement="top"
                                popover-animation="true"
                                popover-trigger="'outsideClick'"
                                popover-is-open="vm.isOpen">
                            <span class="icon-clock mrg__auto"></span>
                        </button>
                    </div>

                    <button class="btn btn--not-style btn--attach btn--size_m btn--not-events width--size28 icon-affix font__size16 mrg--l5 compose-send__item"
                            type="file"
                            multiple
                            accept="**/*"
                            ngf-select="vm.upload($files, $invalidFiles)">
                        <!--<span class="icon-attach"></span>-->
                    </button>

                </div>
            </div>
            <div class="col-xs-6">
                <p class="font__size13 pull-right" ng-if="vm.sendForm.id">
                    {{ 'SAVED_AS_DRAFT_IN' | translate }}
                    <to-date date="vm.sendForm.model.date.date"></to-date>
                </p>
            </div>
        </div>

        <div class="row mrg--t20">
            <div class="col-xs-12">
                <attach-upload attachments-data="vm.sendForm.model.attachmentsData"
                               message="vm.sendForm"
                               is-uploading="vm.isUploading"></attach-upload>

            </div>
        </div>

        <div class="row mrg--t20" ng-if="vm.fwd.items.length >= 2">
            <div class="col-xs-12">
                <div ng-repeat="fwd in vm.fwd.items">
                    <div class="inbox-message__checked">
                        <div class="checkbox-y checkbox-y--size14" ng-click="$event.stopPropagation();">
                            <label class="checkbox-y__label">
                                <input class="checkbox-y__input"
                                       type="checkbox"
                                       data-checklist-model="vm.fwd.checked" data-checklist-value="fwd">
                                <div class="checkbox-y__body">
                                    <span class="checkbox-y__icon"></span>
                                </div>
                                <div class="checkbox-y__text">
                                    {{ 'SEND' | translate }} «<a
                                        ui-sref="mail.message({id: fwd.number, mbox: fwd.mbox, connection_id: fwd.connection_id})"
                                        target="_blank">{{ fwd.Subject ? fwd.Subject : 'NOT_TITLE'| translate }}»</a>
                                    <!--target="_blank">{{ fwd.Subject ? fwd.Subject : '(' + {{ 'NOT_SUBJECT' | translate }} + ')' }}»</a>-->
                                    {{ 'AN_ATTACHMENT' | translate }}
                                </div>
                            </label>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>
</form>
